name: ðŸ“Š GitHub Metrics

on:
    push:
    pull_request:
    create:
    workflow_dispatch:

jobs:
    generate-metrics:
        runs-on: ubuntu-latest
        permissions:
            contents: write
        steps:
            - name: ðŸ§® Generate GitHub Metrics
              uses: lowlighter/metrics@latest
              with:
                  token: ${{ secrets.METRIC_TOKEN }}
                  user: RAJ8664
                  repo: Repo
                  filename: metrics.repository.svg
                  template: repository

                  plugin_lines: yes
                  plugin_followup: yes
                  plugin_projects: yes
                  plugin_projects_repositories: RAJ8664/Prep

                  base: header, activity, community, repositories, metadata
                  config_order: base.header, base.activity, base.community, base.repositories, base.metadata
                  config_timezone: Asia/Kolkata
                  config_display: large
                  config_padding: 12%

            - name: ðŸš€ Commit updated metrics
              run: |
                  git config --global user.name "github-actions[bot]"
                  git config --global user.email "github-actions[bot]@users.noreply.github.com"
                  git pull --rebase
                  git add metrics.repository.svg
                  git commit -m "ðŸ“Š Update metrics" || echo "No changes to commit"
                  git push
